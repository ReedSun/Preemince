<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="ReedSun">
<meta property="og:type" content="website">
<meta property="og:title" content="Preeminent">
<meta property="og:url" content="http://reedsun.top/page/2/index.html">
<meta property="og:site_name" content="Preeminent">
<meta property="og:description" content="ReedSun">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Preeminent">
<meta name="twitter:description" content="ReedSun">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://reedsun.top/page/2/"/>





  <title>Preeminent</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Preeminent</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">I have on idea about subtitle yet</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2017/03/07/CORS跨域/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/07/CORS跨域/" itemprop="url">跨域资源共享 CORS 详解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-07T19:59:04+08:00">
                2017-03-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="跨域资源共享-CORS-详解"><a href="#跨域资源共享-CORS-详解" class="headerlink" title="跨域资源共享 CORS 详解"></a>跨域资源共享 CORS 详解</h1><p>作者： 阮一峰</p>
<p>日期： 2016年4月12日</p>
<p>本文转载自<a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="external">跨域资源共享CORS - 阮一峰</a>， 我觉得阮老师写的非常好！深入浅出！就转载过来啦~</p>
<p>CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing）。<br>它允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p>
<p>本文详细介绍CORS的内部机制。</p>
<h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><p>CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。</p>
<p>整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。</p>
<p>因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信。</p>
<h2 id="二、两种请求"><a href="#二、两种请求" class="headerlink" title="二、两种请求"></a>二、两种请求</h2><p>浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。</p>
<p>只要同时满足以下两大条件，就属于简单请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">（1) 请求方法是以下三种方法之一：</div><div class="line">HEAD</div><div class="line">GET</div><div class="line">POST</div><div class="line">（2）HTTP的头信息不超出以下几种字段：</div><div class="line">Accept</div><div class="line">Accept-Language</div><div class="line">Content-Language</div><div class="line">Last-Event-ID</div><div class="line">Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain</div></pre></td></tr></table></figure></p>
<p>凡是不同时满足上面两个条件，就属于非简单请求。</p>
<p>浏览器对这两种请求的处理，是不一样的。</p>
<h2 id="三、简单请求"><a href="#三、简单请求" class="headerlink" title="三、简单请求"></a>三、简单请求</h2><h3 id="3-1-基本流程"><a href="#3-1-基本流程" class="headerlink" title="3.1 基本流程"></a>3.1 基本流程</h3><p>对于简单请求，浏览器直接发出CORS请求。具体来说，就是在头信息之中，增加一个Origin字段。</p>
<p>下面是一个例子，浏览器发现这次跨源AJAX请求是简单请求，就自动在头信息之中，添加一个Origin字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">GET /cors HTTP/1.1</div><div class="line">Origin: http://api.bob.com</div><div class="line">Host: api.alice.com</div><div class="line">Accept-Language: en-US</div><div class="line">Connection: keep-alive</div><div class="line">User-Agent: Mozilla/5.0...</div></pre></td></tr></table></figure></p>
<p>上面的头信息中，Origin字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。</p>
<p>如果Origin指定的源，不在许可范围内，服务器会返回一个正常的HTTP回应。浏览器发现，这个回应的头信息没有包含Access-Control-Allow-Origin字段（详见下文），就知道出错了，从而抛出一个错误，被XMLHttpRequest的onerror回调函数捕获。注意，这种错误无法通过状态码识别，因为HTTP回应的状态码有可能是200。<br>如果Origin指定的域名在许可范围内，服务器返回的响应，会多出几个头信息字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Origin: http://api.bob.com</div><div class="line">Access-Control-Allow-Credentials: true</div><div class="line">Access-Control-Expose-Headers: FooBar</div><div class="line">Content-Type: text/html; charset=utf-8</div></pre></td></tr></table></figure></p>
<p>上面的头信息之中，有三个与CORS请求相关的字段，都以Access-Control-开头。</p>
<p>（1）Access-Control-Allow-Origin</p>
<p>该字段是必须的。它的值要么是请求时Origin字段的值，要么是一个*，表示接受任意域名的请求。</p>
<p>（2）Access-Control-Allow-Credentials</p>
<p>该字段可选。它的值是一个布尔值，表示是否允许发送Cookie。默认情况下，Cookie不包括在CORS请求之中。设为true，即表示服务器明确许可，Cookie可以包含在请求中，一起发给服务器。这个值也只能设为true，如果服务器不要浏览器发送Cookie，删除该字段即可。</p>
<p>（3）Access-Control-Expose-Headers</p>
<p>该字段可选。CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。上面的例子指定，getResponseHeader(‘FooBar’)可以返回FooBar字段的值。</p>
<h3 id="3-2-withCredentials-属性"><a href="#3-2-withCredentials-属性" class="headerlink" title="3.2 withCredentials 属性"></a>3.2 withCredentials 属性</h3><p>上面说到，CORS请求默认不发送Cookie和HTTP认证信息。如果要把Cookie发到服务器，一方面要服务器同意，指定Access-Control-Allow-Credentials字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Credentials: true</div></pre></td></tr></table></figure></p>
<p>另一方面，开发者必须在AJAX请求中打开withCredentials属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var xhr = new XMLHttpRequest();</div><div class="line">xhr.withCredentials = true;</div></pre></td></tr></table></figure></p>
<p>否则，即使服务器同意发送Cookie，浏览器也不会发送。或者，服务器要求设置Cookie，浏览器也不会处理。</p>
<p>但是，如果省略withCredentials设置，有的浏览器还是会一起发送Cookie。这时，可以显式关闭withCredentials。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xhr.withCredentials = false;</div></pre></td></tr></table></figure></p>
<p>需要注意的是，如果要发送Cookie，Access-Control-Allow-Origin就不能设为星号，必须指定明确的、与请求网页一致的域名。同时，Cookie依然遵循同源政策，只有用服务器域名设置的Cookie才会上传，其他域名的Cookie并不会上传，且（跨源）原网页代码中的document.cookie也无法读取服务器域名下的Cookie。</p>
<h2 id="四、非简单请求"><a href="#四、非简单请求" class="headerlink" title="四、非简单请求"></a>四、非简单请求</h2><h3 id="4-1-预检请求"><a href="#4-1-预检请求" class="headerlink" title="4.1 预检请求"></a>4.1 预检请求</h3><p>非简单请求是那种对服务器有特殊要求的请求，比如请求方法是PUT或DELETE，或者Content-Type字段的类型是application/json。</p>
<p>非简单请求的CORS请求，会在正式通信之前，增加一次HTTP查询请求，称为”预检”请求（preflight）。</p>
<p>浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的XMLHttpRequest请求，否则就报错。</p>
<p>下面是一段浏览器的JavaScript脚本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">var url = &apos;http://api.alice.com/cors&apos;;</div><div class="line">var xhr = new XMLHttpRequest();</div><div class="line">xhr.open(&apos;PUT&apos;, url, true);</div><div class="line">xhr.setRequestHeader(&apos;X-Custom-Header&apos;, &apos;value&apos;);</div><div class="line">xhr.send();</div></pre></td></tr></table></figure></p>
<p>上面代码中，HTTP请求的方法是PUT，并且发送一个自定义头信息X-Custom-Header。<br>浏览器发现，这是一个非简单请求，就自动发出一个”预检”请求，要求服务器确认可以这样请求。下面是这个”预检”请求的HTTP头信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">OPTIONS /cors HTTP/1.1</div><div class="line">Origin: http://api.bob.com</div><div class="line">Access-Control-Request-Method: PUT</div><div class="line">Access-Control-Request-Headers: X-Custom-Header</div><div class="line">Host: api.alice.com</div><div class="line">Accept-Language: en-US</div><div class="line">Connection: keep-alive</div><div class="line">User-Agent: Mozilla/5.0...</div></pre></td></tr></table></figure></p>
<p>“预检”请求用的请求方法是OPTIONS，表示这个请求是用来询问的。头信息里面，关键字段是Origin，表示请求来自哪个源。<br>除了Origin字段，”预检”请求的头信息包括两个特殊字段。</p>
<p>（1）Access-Control-Request-Method</p>
<p>该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，上例是PUT。</p>
<p>（2）Access-Control-Request-Headers</p>
<p>该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，上例是X-Custom-Header。</p>
<h3 id="4-2-预检请求的回应"><a href="#4-2-预检请求的回应" class="headerlink" title="4.2 预检请求的回应"></a>4.2 预检请求的回应</h3><p>服务器收到”预检”请求以后，检查了Origin、Access-Control-Request-Method和Access-Control-Request-Headers字段以后，确认允许跨源请求，就可以做出回应。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 200 OK</div><div class="line">Date: Mon, 01 Dec 2008 01:15:39 GMT</div><div class="line">Server: Apache/2.0.61 (Unix)</div><div class="line">Access-Control-Allow-Origin: http://api.bob.com</div><div class="line">Access-Control-Allow-Methods: GET, POST, PUT</div><div class="line">Access-Control-Allow-Headers: X-Custom-Header</div><div class="line">Content-Type: text/html; charset=utf-8</div><div class="line">Content-Encoding: gzip</div><div class="line">Content-Length: 0</div><div class="line">Keep-Alive: timeout=2, max=100</div><div class="line">Connection: Keep-Alive</div><div class="line">Content-Type: text/plain</div></pre></td></tr></table></figure></p>
<p>上面的HTTP回应中，关键的是Access-Control-Allow-Origin字段，表示<a href="http://api.bob.com可以请求数据。该字段也可以设为星号，表示同意任意跨源请求。" target="_blank" rel="external">http://api.bob.com可以请求数据。该字段也可以设为星号，表示同意任意跨源请求。</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Origin: *</div></pre></td></tr></table></figure></p>
<p>如果浏览器否定了”预检”请求，会返回一个正常的HTTP回应，但是没有任何CORS相关的头信息字段。这时，浏览器就会认定，服务器不同意预检请求，因此触发一个错误，被XMLHt<br>tpRequest对象的onerror回调函数捕获。控制台会打印出如下的报错信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">XMLHttpRequest cannot load http://api.alice.com.</div><div class="line">Origin http://api.bob.com is not allowed by Access-Control-Allow-Origin.</div></pre></td></tr></table></figure></p>
<p>服务器回应的其他CORS相关字段如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Methods: GET, POST, PUT</div><div class="line">Access-Control-Allow-Headers: X-Custom-Header</div><div class="line">Access-Control-Allow-Credentials: true</div><div class="line">Access-Control-Max-Age: 1728000</div></pre></td></tr></table></figure></p>
<p>（1）Access-Control-Allow-Methods</p>
<p>该字段必需，它的值是逗号分隔的一个字符串，表明服务器支持的所有跨域请求的方法。注意，返回的是所有支持的方法，而不单是浏览器请求的那个方法。这是为了避免多次”预检”请求。</p>
<p>（2）Access-Control-Allow-Headers</p>
<p>如果浏览器请求包括Access-Control-Request-Headers字段，则Access-Control-Allow-Headers字段是必需的。它也是一个逗号分隔的字符串，表明服务器支持的所有头信息字段，不限于浏览器在”预检”中请求的字段。</p>
<p>（3）Access-Control-Allow-Credentials</p>
<p>该字段与简单请求时的含义相同。</p>
<p>（4）Access-Control-Max-Age</p>
<p>该字段可选，用来指定本次预检请求的有效期，单位为秒。上面结果中，有效期是20天（1728000秒），即允许缓存该条回应1728000秒（即20天），在此期间，不用发出另一条预检请求。</p>
<h3 id="4-3-浏览器的正常请求和回应"><a href="#4-3-浏览器的正常请求和回应" class="headerlink" title="4.3 浏览器的正常请求和回应"></a>4.3 浏览器的正常请求和回应</h3><p>一旦服务器通过了”预检”请求，以后每次浏览器正常的CORS请求，就都跟简单请求一样，会有一个Origin头信息字段。服务器的回应，也都会有一个Access-Control-Allow-Origin头信息字段。</p>
<p>下面是”预检”请求之后，浏览器的正常CORS请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">PUT /cors HTTP/1.1</div><div class="line">Origin: http://api.bob.com</div><div class="line">Host: api.alice.com</div><div class="line">X-Custom-Header: value</div><div class="line">Accept-Language: en-US</div><div class="line">Connection: keep-alive</div><div class="line">User-Agent: Mozilla/5.0...</div></pre></td></tr></table></figure></p>
<p>上面头信息的Origin字段是浏览器自动添加的。</p>
<p>下面是服务器正常的回应。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Access-Control-Allow-Origin: http://api.bob.com</div><div class="line">Content-Type: text/html; charset=utf-8</div></pre></td></tr></table></figure></p>
<p>上面头信息中，Access-Control-Allow-Origin字段是每次回应都必定包含的。</p>
<h2 id="五、与JSONP的比较"><a href="#五、与JSONP的比较" class="headerlink" title="五、与JSONP的比较"></a>五、与JSONP的比较</h2><p>CORS与JSONP的使用目的相同，但是比JSONP更强大。</p>
<p>JSONP只支持GET请求，CORS支持所有类型的HTTP请求。JSONP的优势在于支持老式浏览器，以及可以向不支持CORS的网站请求数据。</p>
<p>（完）</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2017/02/27/解决jQuery的$冲突问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/27/解决jQuery的$冲突问题/" itemprop="url">解决jQuery的$冲突问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-27T21:26:43+08:00">
                2017-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="解决jQuery的-冲突问题"><a href="#解决jQuery的-冲突问题" class="headerlink" title="解决jQuery的$冲突问题"></a>解决jQuery的$冲突问题</h1><p>很多JavaScript的库使用<code>$</code>作为变量名，如果我们同时引用两个使用<code>$</code>作为变量名，或者引入两个不同版本的jQuery时，就可能会出现<code>$</code>冲突问题。</p>
<p>作为解决办法，我们可以使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jQuery.noConflict()</div></pre></td></tr></table></figure></p>
<p>来解决这个问题。</p>
<h2 id="jQuery-noConflict"><a href="#jQuery-noConflict" class="headerlink" title="jQuery.noConflict()"></a>jQuery.noConflict()</h2><p><code>jQuery.noConflict()</code>的作用是放弃jQuery控制$ 变量。</p>
<h2 id="具体应用方法"><a href="#具体应用方法" class="headerlink" title="具体应用方法"></a>具体应用方法</h2><h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>一种方法是使用<code>jQuery</code>来代替<code>$</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;other_lib.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    $.noConflict();    // 让jQuery放弃$变量的控制</div><div class="line">    jQuery(&quot;div&quot;)...   // 使用jQuery来代替$</div><div class="line">    $(&quot;div&quot;)...        // 其他库正常使用$</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>第一种方法有一个问题是我们必须全部使用<code>jQuery</code>来代替<code>$</code>，如果我们还想用<code>$</code>，我们可以参考以下两种方法。</p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>这种方法是使用<code>jQuery.ready()</code>形成闭包，在闭包中运行jQuery代码</p>
<p><code>jQuery.ready()</code> =&gt; 当DOM准备就绪时，指定一个函数来执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;other_lib.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    $.noConflict();    // 让jQuery放弃$变量的控制</div><div class="line">    jQuery(document).ready(funciton($)&#123;</div><div class="line">        ...            // jQuery代码在这里 </div><div class="line">        &#125;)   </div><div class="line">    ...                // 其他库代码在这里</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h3><p>这种方法是使用立即执行函数，让<code>$</code>作为函数的变量，调用<code>jQuery</code>作为<code>$</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;other_lib.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script src=&quot;jquery.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script&gt;</div><div class="line">    $.noConflict();    // 让jQuery放弃$变量的控制</div><div class="line">    (function($)&#123;&#125;</div><div class="line">        ...            // jQuery代码在这里</div><div class="line">    )(jQuery)  </div><div class="line">    ...                // 其他库代码在这里</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2017/02/26/Vuex的五个核心属性/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/26/Vuex的五个核心属性/" itemprop="url">Vuex的五个核心概念</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-26T13:34:10+08:00">
                2017-02-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文参考自<a href="http://vuex.vuejs.org/zh-cn/" target="_blank" rel="external">Vue文档</a>，说的非常详细，建议看文档。</p>
<h2 id="Vuex是什么？"><a href="#Vuex是什么？" class="headerlink" title="Vuex是什么？"></a>Vuex是什么？</h2><p>VueX 是一个专门为 Vue.js 应用设计的状态管理架构，统一管理和维护各个vue组件的可变化状态(你可以理解成 vue 组件里的某些 data )。</p>
<p>Vue有五个核心概念，<code>state</code>, <code>getters</code>, <code>mutations</code>, <code>actions</code>, <code>modules</code>。本文将对这个五个核心概念进行梳理。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p> state =&gt; 基本数据<br> getters =&gt; 从基本数据派生的数据<br> mutations =&gt; 提交更改数据的方法，同步！<br> actions =&gt; 像一个装饰器，包裹mutations，使之可以异步。<br> modules =&gt; 模块化Vuex</p>
<h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p>state即Vuex中的基本数据！</p>
<h4 id="单一状态树"><a href="#单一状态树" class="headerlink" title="单一状态树"></a>单一状态树</h4><p>Vuex使用单一状态树，即用一个对象就包含了全部的状态数据。<code>state</code>作为构造器选项，定义了所有我们需要的基本状态参数。</p>
<h4 id="在Vue组件中获得Vuex属性"><a href="#在Vue组件中获得Vuex属性" class="headerlink" title="在Vue组件中获得Vuex属性"></a>在Vue组件中获得Vuex属性</h4><ul>
<li>我们可以通过Vue的<code>Computed</code>获得Vuex的state，如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">    state: &#123;</div><div class="line">        count:0</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line">const app = new Vue(&#123;</div><div class="line">    //..</div><div class="line">    store,</div><div class="line">    computed: &#123;</div><div class="line">        count: function()&#123;</div><div class="line">            return this.$store.state.count</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    //..</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p>每当 <code>store.state.count</code> 变化的时候, 都会重新求取计算属性，并且触发更新相关联的 DOM。</p>
<h4 id="mapState辅助函数"><a href="#mapState辅助函数" class="headerlink" title="mapState辅助函数"></a>mapState辅助函数</h4><p>当一个组件需要获取多个状态时候，将这些状态都声明为计算属性会有些重复和冗余。为了解决这个问题，我们可以使用 mapState 辅助函数帮助我们生成计算属性，让你少按几次键。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// 在单独构建的版本中辅助函数为 Vuex.mapState</div><div class="line">import &#123; mapState &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  // ...</div><div class="line">  computed: mapState(&#123;</div><div class="line">    // 箭头函数可使代码更简练</div><div class="line">    count: state =&gt; state.count,</div><div class="line"></div><div class="line">    // 传字符串参数 &apos;count&apos; 等同于 `state =&gt; state.count`</div><div class="line">    countAlias: &apos;count&apos;,</div><div class="line"></div><div class="line">    // 为了能够使用 `this` 获取局部状态，必须使用常规函数</div><div class="line">    countPlusLocalState (state) &#123;</div><div class="line">      return state.count + this.localCount</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>当映射的计算属性的名称与 state 的子节点名称相同时，我们也可以给 mapState 传一个字符串数组。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">computed: mapState([</div><div class="line">  // 映射 this.count 为 store.state.count</div><div class="line">  &apos;count&apos;</div><div class="line">])</div></pre></td></tr></table></figure></p>
<h4 id="对象展开运算符"><a href="#对象展开运算符" class="headerlink" title="对象展开运算符"></a>对象展开运算符</h4><p>mapState 函数返回的是一个对象。我们如何将它与局部计算属性混合使用呢？通常，我们需要使用一个工具函数将多个对象合并为一个，以使我们可以将最终对象传给 computed 属性。但是自从有了对象展开运算符，我们可以极大地简化写法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">computed: &#123;</div><div class="line">  localComputed () //本地计算属性</div><div class="line">  //使用对象展开运算符将此对象混入到外部对象中</div><div class="line">  ...mapState(&#123;</div><div class="line">    //..</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li><p>对象运算符<br>  <code>...</code> 展开运算符（spread operator）允许一个表达式在某处展开。展开运算符在多个参数（用于函数调用）或多个元素（用于数组字面量）或者多个变量（用于解构赋值）的地方可以使用。</p>
<p>  展开运算符不能用在对象当中，因为目前展开运算符只能在可遍历对象（iterables）可用。iterables的实现是依靠[Symbol.iterator]函数，而目前只有Array,Set,String内置[Symbol.iterator]方法，而Object尚未内置该方法，因此无法使用展开运算符。不过ES7草案当中已经加入了对象展开运算符特性。</p>
<p>  例子：</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function test(a,b,c) &#123;</div><div class="line">    console.log(a);</div><div class="line">    console.log(b);</div><div class="line">    console.log(c);</div><div class="line">&#125;</div><div class="line">var args = [0,1,2];</div><div class="line">test(...args);  // 0  1  2</div></pre></td></tr></table></figure>
<ul>
<li>ES7草案中的对象展开运算符<br>  ES6中还不支持对对象的展开运算符，但是ES7中将支持。对象展开运算符符可以让我们更快捷地操作对象，如下例子：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">let &#123;x,y,...z&#125;=&#123;x:1,y:2,a:3,b:4&#125;;</div><div class="line">x; //1</div><div class="line">y; //2</div><div class="line">z; //&#123;a:3,b:4&#125;</div></pre></td></tr></table></figure>
<h4 id="组件仍然保有局部状态"><a href="#组件仍然保有局部状态" class="headerlink" title="组件仍然保有局部状态"></a>组件仍然保有局部状态</h4><p>使用 Vuex 并不意味着你需要将所有的状态放入 Vuex。虽然将所有的状态放到 Vuex 会使状态变化更显式和易调试，但也会使代码变得冗长和不直观。</p>
<p>如果有些状态严格属于单个组件，最好还是作为组件的局部状态。你应该根据你的应用开发需要进行权衡和确定。</p>
<h2 id="getters"><a href="#getters" class="headerlink" title="getters"></a>getters</h2><p>即从store的<code>state</code>中派生出的状态。</p>
<p>getters接收state作为其第一个参数，接受其他 getters 作为第二个参数，如不需要，第二个参数可以省略如下例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">    state: &#123;</div><div class="line">        count:0</div><div class="line">    &#125;，</div><div class="line">    getters: &#123;</div><div class="line">        // 单个参数</div><div class="line">        countDouble: function(state)&#123;</div><div class="line">            return state.count * 2</div><div class="line">        &#125;,</div><div class="line">        // 两个参数</div><div class="line">        countDoubleAndDouble: function(state, getters) &#123;</div><div class="line">            return getters.countDouble * 2</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>与state一样，我们也可以通过Vue的<code>Computed</code>获得Vuex的getters。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">const app = new Vue(&#123;</div><div class="line">    //..</div><div class="line">    store,</div><div class="line">    computed: &#123;</div><div class="line">        count: function()&#123;</div><div class="line">            return this.$store.state.count</div><div class="line">        &#125;,</div><div class="line">        countDouble: function()&#123;</div><div class="line">            return this.$store.getters.countDouble</div><div class="line">        &#125;,</div><div class="line">        countDoubleAndDouble: function()&#123;</div><div class="line">            return this.$store.getters.countDoubleAndDouble</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    //..</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h4 id="mapGetters-辅助函数"><a href="#mapGetters-辅助函数" class="headerlink" title="mapGetters 辅助函数"></a>mapGetters 辅助函数</h4><p>mapGetters 辅助函数仅仅是将 store 中的 getters 映射到局部计算属性，与state类似<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import &#123; mapGetters &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  // ...</div><div class="line">  computed: &#123;</div><div class="line">  // 使用对象展开运算符将 getters 混入 computed 对象中</div><div class="line">    ...mapGetters([</div><div class="line">      &apos;countDouble&apos;,</div><div class="line">      &apos;CountDoubleAndDouble&apos;,</div><div class="line">      //..</div><div class="line">    ])</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>如果你想将一个 getter 属性另取一个名字，使用对象形式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mapGetters(&#123;</div><div class="line">  // 映射 this.double 为 store.getters.countDouble</div><div class="line">  double: &apos;countDouble&apos;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="mutations"><a href="#mutations" class="headerlink" title="mutations"></a>mutations</h2><p>提交mutation是更改Vuex中的store中的状态的唯一方法。</p>
<p>mutation必须是同步的，如果要异步需要使用action。</p>
<p>每个 mutation 都有一个字符串的 事件类型 (type) 和 一个 回调函数 (handler)。这个回调函数就是我们实际进行状态更改的地方，并且它会接受 state 作为第一个参数，提交载荷作为第二个参数。（提交荷载在大多数情况下应该是一个对象）,提交荷载也可以省略的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  state: &#123;</div><div class="line">    count: 1</div><div class="line">  &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    //无提交荷载</div><div class="line">    increment(state) &#123;</div><div class="line">        state.count++</div><div class="line">    &#125;</div><div class="line">    //提交荷载</div><div class="line">    incrementN(state, obj) &#123;</div><div class="line">      state.count += obj.n</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>你不能直接调用一个 mutation handler。这个选项更像是事件注册：“当触发一个类型为 increment 的 mutation 时，调用此函数。”要唤醒一个 mutation handler，你需要以相应的 type 调用 store.commit 方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">//无提交荷载</div><div class="line">store.commit(&apos;increment&apos;)</div><div class="line">//提交荷载</div><div class="line">store.commit(&apos;incrementN&apos;, &#123;</div><div class="line">    n: 100</div><div class="line">    &#125;)</div></pre></td></tr></table></figure></p>
<h4 id="对象风格的提交方式"><a href="#对象风格的提交方式" class="headerlink" title="对象风格的提交方式"></a>对象风格的提交方式</h4><p>我们也可以使用这样包含 type 属性的对象的提交方式。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">store.commit(&#123;</div><div class="line">  type: &apos;incrementN&apos;,</div><div class="line">  n: 10</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h3 id="Mutations-需遵守-Vue-的响应规则"><a href="#Mutations-需遵守-Vue-的响应规则" class="headerlink" title="Mutations 需遵守 Vue 的响应规则"></a>Mutations 需遵守 Vue 的响应规则</h3><ul>
<li>最好提前在你的 store 中初始化好所有所需属性。</li>
<li>当需要在对象上添加新属性时，你应该<ul>
<li>使用 <code>Vue.set(obj, &#39;newProp&#39;, 123)</code>, 或者</li>
<li>以新对象替换老对象。例如，利用对象展开运算符我们可以这样写<code>state.obj = {...state.obj, newProp: 123 }</code></li>
</ul>
</li>
</ul>
<h3 id="mapMutations-辅助函数"><a href="#mapMutations-辅助函数" class="headerlink" title="mapMutations 辅助函数"></a>mapMutations 辅助函数</h3><p>与其他辅助函数类似，你可以在组件中使用 this.$store.commit(‘xxx’) 提交 mutation，或者使用 mapMutations 辅助函数将组件中的 methods 映射为 store.commit 调用（需要在根节点注入 store）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import &#123; mapMutations &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  //..</div><div class="line">  methods: &#123;</div><div class="line">    ...mapMutations([</div><div class="line">      &apos;increment&apos; // 映射 this.increment() 为 this.$store.commit(&apos;increment&apos;)</div><div class="line">    ]),</div><div class="line">    ...mapMutations(&#123;</div><div class="line">      add: &apos;increment&apos; // 映射 this.add() 为 this.$store.commit(&apos;increment&apos;)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h3><p>Action 类似于 mutation，不同在于：</p>
<ul>
<li>Action 提交的是 mutation，而不是直接变更状态。</li>
<li>Action 可以包含任意异步操作。</li>
</ul>
<p>我们用如下例子来结束actions：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  state: &#123;</div><div class="line">    count: 0</div><div class="line">  &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    increment (state) &#123;</div><div class="line">      state.count++</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  actions: &#123;</div><div class="line">    increment (context) &#123;</div><div class="line">      setInterval(function()&#123;</div><div class="line">        context.commit(&apos;increment&apos;)</div><div class="line">      &#125;, 1000)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><strong>注意：Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象</strong>，因此你可以调用 context.commit 提交一个 mutation，或者通过 context.state 和 context.getters 来获取 state 和 getters。</p>
<h3 id="分发actions"><a href="#分发actions" class="headerlink" title="分发actions"></a>分发actions</h3><p>Action 通过 <code>store.dispatch</code> 方法触发：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">store.dispatch(&apos;increment&apos;)</div></pre></td></tr></table></figure></p>
<h3 id="其他与mutations类似的地方"><a href="#其他与mutations类似的地方" class="headerlink" title="其他与mutations类似的地方"></a>其他与mutations类似的地方</h3><p>Actions 支持同样的载荷方式和对象方式进行分发：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 以载荷形式分发</div><div class="line">store.dispatch(&apos;incrementN&apos;, &#123;</div><div class="line">  n: 10</div><div class="line">&#125;)</div><div class="line"></div><div class="line">// 以对象形式分发</div><div class="line">store.dispatch(&#123;</div><div class="line">  type: &apos;incrementN&apos;,</div><div class="line">  n: 10</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>mapActions辅助函数</p>
<p>你在组件中使用 <code>this.$store.dispatch(&#39;xxx&#39;)</code> 分发 action，或者使用 <code>mapActions</code> 辅助函数将组件的 methods 映射为 <code>store.dispatch</code> 调用（需要先在根节点注入 <code>store</code>）:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">import &#123; mapActions &#125; from &apos;vuex&apos;</div><div class="line"></div><div class="line">export default &#123;</div><div class="line">  //..</div><div class="line">  methods: &#123;</div><div class="line">    ...mapActions([</div><div class="line">      &apos;incrementN&apos; //映射 this.incrementN() 为 this.$store.dispatch(&apos;incrementN&apos;)</div><div class="line">    ]),</div><div class="line">    ...mapActions(&#123;</div><div class="line">      add: &apos;incrementN&apos; //映射 this.add() 为 this.$store.dispatch(&apos;incrementN&apos;)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h2><p>使用单一状态树，导致应用的所有状态集中到一个很大的对象。但是，当应用变得很大时，store 对象会变得臃肿不堪。</p>
<p>为了解决以上问题，Vuex 允许我们将 store 分割到模块（module）。每个模块拥有自己的 state、mutation、action、getters、甚至是嵌套子模块——从上至下进行类似的分割：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">const moduleA = &#123;</div><div class="line">  state: &#123; ... &#125;,</div><div class="line">  mutations: &#123; ... &#125;,</div><div class="line">  actions: &#123; ... &#125;,</div><div class="line">  getters: &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const moduleB = &#123;</div><div class="line">  state: &#123; ... &#125;,</div><div class="line">  mutations: &#123; ... &#125;,</div><div class="line">  actions: &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const store = new Vuex.Store(&#123;</div><div class="line">  modules: &#123;</div><div class="line">    a: moduleA,</div><div class="line">    b: moduleB</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">store.state.a // -&gt; moduleA 的状态</div><div class="line">store.state.b // -&gt; moduleB 的状态</div></pre></td></tr></table></figure></p>
<h3 id="模块的局部状态"><a href="#模块的局部状态" class="headerlink" title="模块的局部状态"></a>模块的局部状态</h3><p>对于模块内部的 <code>mutation</code> 和 <code>getter</code>，接收的第一个参数是模块的局部状态,对于模块内部的 getter，根节点状态会作为第三个参数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">const moduleA = &#123;</div><div class="line">  state: &#123; count: 0 &#125;,</div><div class="line">  mutations: &#123;</div><div class="line">    increment (state) &#123;</div><div class="line">      // state 模块的局部状态</div><div class="line">      state.count++</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  getters: &#123;</div><div class="line">    doubleCount (state) &#123;</div><div class="line">      return state.count * 2</div><div class="line">    &#125;,</div><div class="line">    sumWithRootCount (state, getters, rootState) &#123;</div><div class="line">      return state.count + rootState.count</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>同样，对于模块内部的 action，<code>context.state</code> 是局部状态，根节点的状态是 <code>context.rootState</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">const moduleA = &#123;</div><div class="line">  // ...</div><div class="line">  actions: &#123;</div><div class="line">    incrementIfOddOnRootSum (context) &#123;</div><div class="line">      if ((context.state.count + context.rootState.count) % 2 === 1) &#123;</div><div class="line">        commit(&apos;increment&apos;)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2017/02/09/关于flex，好像有12个属性很重要/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/09/关于flex，好像有12个属性很重要/" itemprop="url">关于Flex，有12个属性很重要</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-09T00:46:59+08:00">
                2017-02-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这几天在学习<code>Flex</code>布局，发现<code>Flex</code>真的好厉害！</p>
<p>Flex是Flexible Box的缩写，意为“弹性布局”，用来为盒模型提供最大的灵活性。</p>
<p><code>Flex</code>是它可以简单、完整、响应式的实现各种网页布局，目前已经得到了大多数主流浏览器的支持，有关于它的兼容性可以在<code>CanIuse</code>中的查询到：</p>
<p><img src="http://i1.piimg.com/567571/28c7e024eb4e68b0.png" alt=""></p>
<p>任何一个容器都可以指定为Flex布局</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.box &#123;</div><div class="line">    display: flex;</div><div class="line">&#125;</div><div class="line">.box &#123;</div><div class="line">    display: inline-flex;  // 行内元素通过这种方式指定为Flex布局</div><div class="line">&#125;</div><div class="line">.box &#123;</div><div class="line">    display: -webkit-flex  // Webkit内核浏览器使用此方式指定为Flex布局</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这篇文章是我对<code>Flex</code>的总结，文章中的内容主要借鉴自<a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="external">Flex布局教程 by阮一峰</a>、<a href="http://www.jirengu.com/app/video/1412" target="_blank" rel="external">flex布局 by饥人谷方方老师</a>。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li><code>flex container</code>：采用<code>Flex</code>布局的元素，即父元素，称为<strong>Flex容器</strong>，简称容器。</li>
<li><code>flex item</code>：父元素内包含的子元素，称为<strong>Flex项目</strong>，简称项目。</li>
<li>Flex是没有方向之分的，在Flex容器中默认存在两根轴，水平的轴为 <strong>主轴main axis</strong>，垂直的轴为 <strong>侧轴cross axis</strong>。（如果改变<code>flex-direction</code>，主轴和侧轴也将会改变）</li>
<li>主轴的开始位置（与边框的交叉点）叫做 <strong>main start</strong> ，结束位置叫做 <strong>main end</strong> 。</li>
<li>侧轴的开始位置叫做 <strong>cross start</strong> ， 结束位置叫做 <strong>cross end</strong> 。</li>
<li>项目默认沿主轴方向排列，单个项目占据的主轴空间叫做 <strong>main size</strong> ，侧轴空间叫做 <strong>cross size</strong> 。</li>
</ul>
<p>以上概念可以用下图全部展现：</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071004.png" alt=""></p>
<p>注意：设为Flex布局后，子元素的<code>float</code>、<code>clear</code>、<code>vertical-align</code>属性将失效。</p>
<h2 id="容器（父元素）的属性"><a href="#容器（父元素）的属性" class="headerlink" title="容器（父元素）的属性"></a>容器（父元素）的属性</h2><p>容器共有六个属性</p>
<ul>
<li><code>flex-direction</code></li>
<li><code>flex-wrap</code></li>
<li><code>flex-flow</code></li>
<li><code>justify-content</code></li>
<li><code>align-items</code></li>
<li><code>align-content</code></li>
</ul>
<h3 id="flex-direction属性"><a href="#flex-direction属性" class="headerlink" title="flex-direction属性"></a>flex-direction属性</h3><p><code>flex-direction</code>属性决定主轴的方向，它可能有四个值。</p>
<ul>
<li><code>row</code>：默认值，主轴为水平方向，起点在左端。</li>
<li><code>row-reverse</code>：主轴为水平方向，起点在右端。</li>
<li><code>column</code>：主轴为垂直方向，起点在上端。</li>
<li><code>column-reverse</code>：主轴为垂直方向，起点在下端。</li>
</ul>
<p>四种值对应的情况如下图所示：</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071005.png" alt=""></p>
<h3 id="flex-wrap属性"><a href="#flex-wrap属性" class="headerlink" title="flex-wrap属性"></a>flex-wrap属性</h3><p><code>flex-wrap</code>属性决定项目在一行排不下的情况下是否换行，它可能有三种值。</p>
<ul>
<li><code>nowrap</code>：默认值，不换行。</li>
<li><code>wrap</code>：换行，第一行在主轴开始方向，依次往主轴结束方向布置。</li>
<li><code>wrap-reverse</code>：换行，第一行在主轴结束方向，依次往主轴结束方向布置</li>
</ul>
<p>三种值对应的情况如下图所示：</p>
<p><img src="http://i1.piimg.com/567571/53b72f333114133a.png" alt=""></p>
<h3 id="flex-flow属性"><a href="#flex-flow属性" class="headerlink" title="flex-flow属性"></a>flex-flow属性</h3><p><code>flex-flow</code>属性是<code>flex-direction</code>属性和<code>flex-wrap</code>属性的简写形式，默认值为<code>row nowrap</code>。</p>
<h3 id="justify-content属性"><a href="#justify-content属性" class="headerlink" title="justify-content属性"></a>justify-content属性</h3><p><code>justify-content</code>属性定义了项目在主轴上的对齐方式，它可能有五个值。</p>
<ul>
<li><code>flex-start</code>：默认值，主轴开始方向对齐。</li>
<li><code>flex-end</code>：主轴结束方向对齐。</li>
<li><code>center</code>：主轴居中对齐。</li>
<li><code>space-between</code>：两端对齐，项目之间间隔都相等。</li>
<li><code>space-around</code>：每个项目两侧的间隔相等，所以项目之间间隔是项目与边框间隔的两倍。<br>假设主轴为从左到右，五种值对应的情况如下图所示：</li>
</ul>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071010.png" alt=""></p>
<h3 id="align-items属性"><a href="#align-items属性" class="headerlink" title="align-items属性"></a>align-items属性</h3><p><code>align-items</code>属性定义了每行项目在侧轴方向上的对齐方式，它也可能有五个值。</p>
<ul>
<li><code>flex-start</code>：侧轴开始方向对齐。</li>
<li><code>flex-end</code>：侧轴结束方向对齐。</li>
<li><code>center</code>：侧轴居中对齐。</li>
<li><code>baseline</code>：项目第一行文字的基线对齐</li>
<li><code>stretch</code>：默认值，如果项目未设置高度或高度设为auto，将占满整个容器。<br>假设侧轴为从上到下，五种值对应的情况如下图所示：</li>
</ul>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071011.png" alt=""></p>
<h3 id="align-content属性"><a href="#align-content属性" class="headerlink" title="align-content属性"></a>align-content属性</h3><p><code>align-content</code>属性定义了容器在侧轴方向上有额外空间时，如何每排布一行，当容器只有一行时，它不起作用，它可能有六个值。</p>
<ul>
<li><code>flex-start</code>：侧轴开始方向对齐。</li>
<li><code>flex-end</code>：侧轴结束方向对齐。</li>
<li><code>center</code>：侧轴中心中对齐。</li>
<li><code>space-between</code>：与侧轴两端对齐，每行轴线间隔平均。</li>
<li><code>space-around</code>：每根轴线两侧间隔相等。</li>
<li><code>stretch</code>：默认值，占满整个整个侧轴</li>
</ul>
<p>假设侧轴为从上到下，六种值对应的情况如下图所示：</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071012.png" alt=""></p>
<h2 id="项目（子元素的属性）"><a href="#项目（子元素的属性）" class="headerlink" title="项目（子元素的属性）"></a>项目（子元素的属性）</h2><p>项目共有六个属性</p>
<ul>
<li><code>order</code></li>
<li><code>flex-grow</code></li>
<li><code>flex-shrink</code></li>
<li><code>flex-basis</code></li>
<li><code>flex</code></li>
<li><code>align-self</code></li>
</ul>
<h3 id="order属性"><a href="#order属性" class="headerlink" title="order属性"></a>order属性</h3><p><code>order</code>属性定义项目的排列顺序，数值越小排列越靠前，默认为0，可能的值为任意整数。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071013.png" alt=""></p>
<h3 id="flex-grow属性"><a href="#flex-grow属性" class="headerlink" title="flex-grow属性"></a>flex-grow属性</h3><p><code>flex-grow</code>属性定义项目的放大比例，默认为0，即如果存在剩余空间也不放大。</p>
<p>如果所有项目的<code>flex-grow</code>属性都为1，则它们将等分剩余空间（如果有的话）。如果一个项目的<code>flex-grow</code>属性为2，其他项目都为1，则前者占据的剩余空间将比其他项多一倍，如下图所示：</p>
<p><img src="http://p1.bqimg.com/567571/5046fad398a2c988.png" alt=""></p>
<h3 id="flex-shrink属性"><a href="#flex-shrink属性" class="headerlink" title="flex-shrink属性"></a>flex-shrink属性</h3><p><code>flex-shrink</code>属性定义了项目的缩小比例，默认为1，即如果空间不足该项目将缩小。</p>
<p>负值对该属性无效,即该属性可能的值为0或正整数。</p>
<p>如果所有项目的flex-shrink属性都为1，当空间不足时，都将等比例缩小。如果一个项目的flex-shrink属性为0，其他项目都为1，则空间不足时，前者不缩小，如下图所示：</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071015.jpg" alt=""></p>
<h3 id="flex-basis属性"><a href="#flex-basis属性" class="headerlink" title="flex-basis属性"></a>flex-basis属性</h3><p><code>flex-basis</code>属性定义了在分配多余空间之前，项目占据的主轴空间（main-size）。浏览器根据整个属性，计算主轴是否有多余空间。它的默认值为auto，即项目的本来大小。</p>
<p>它可以设为跟width或height属性一样的值（比如350px），则项目将占据固定空间。</p>
<h3 id="flex属性"><a href="#flex属性" class="headerlink" title="flex属性"></a>flex属性</h3><p><code>flex</code>属性是<code>flex-grow</code>, <code>flex-shrink</code> 和 <code>flex-basis</code>的简写，默认值为<code>0 1 auto</code>。后两个属性可选。</p>
<p>该属性有两个快捷值：<code>auto (1 1 auto)</code>（既可以放大占满空间，也可缩小） 和 <code>none (0 0 auto)</code>（不可放大，也不可缩小）。</p>
<p>建议优先使用这个属性，而不是单独写三个分离的属性，因为浏览器会推算相关值。</p>
<h3 id="align-self属性"><a href="#align-self属性" class="headerlink" title="align-self属性"></a>align-self属性</h3><p><code>align-self</code>属性允许单个项目有与其他项目不一样的侧轴对齐方式，可覆盖<code>align-items</code>属性。默认值为<code>auto</code>，表示继承父元素的<code>align-items</code>属性，如果没有父元素，则等同于<code>stretch</code>。</p>
<p>其值除<code>auto</code>外，其他与<code>align-items</code>完全一致。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071016.png" alt=""></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>只要记住了这12个属性，使用Flex布局就肯定没问题啦，在我的GitHub上有几个关于Flex布局的小例子，想复习的朋友可以去试一试，<a href="https://github.com/ReedSun/flex-demo" target="_blank" rel="external">仓库地址在这里</a>。</p>
<p>(完)</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2017/02/05/在GitBash中设置sublime打开文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/05/在GitBash中设置sublime打开文件/" itemprop="url">两步实现在Git Bash中用Sublime打开文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-05T11:40:35+08:00">
                2017-02-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="两步实现在Git-Bash中用Sublime打开文件"><a href="#两步实现在Git-Bash中用Sublime打开文件" class="headerlink" title="两步实现在Git Bash中用Sublime打开文件"></a>两步实现在Git Bash中用Sublime打开文件</h1><p>每次都要用鼠标点来点去才能用sublime打开文件！太不科学！今天来配置一下在git bash中用sublime打开文件</p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ol>
<li>新建一个文件命名为你想要的命令，比如 <code>subl</code>（注意不能有后缀名），内容：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">&quot;C:\Program Files\Sublime Text 3\sublime_text.exe&quot; $1 &amp;</div></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>第一行是说这是个 shell 脚本</li>
<li>第二行的字符串是sublime 的安装目录<strong>注意这里要输入你自己的目录</strong></li>
<li>第二行的$1 是取的命令之后输入的参数</li>
<li>第二行的&amp;是此命令在后台打开，这样sublime打开之后，就不会阻塞你的git bash</li>
</ul>
<ol>
<li>保存到 <code>C:\Program Files (x86)\Git\mingW32\bin</code> 目录下(你的git目录可能与我的不一样，注意改成你自己的)</li>
<li>大功告成~<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">subl xxx</div></pre></td></tr></table></figure>
</li>
</ol>
<p>如果<code>xxx</code>已存在，则打开已存在的文件，如果不存在则打开新文件命名为<code>xxx</code>。</p>
<h2 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h2><p>不光是sublime，感觉用这种方法我们就可以设置更多了，比如用chrome打开<code>.html</code>文件等等。<br>发现更大的世界~yeah!</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2016/11/06/关于python中inspect模块的一些探究/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/11/06/关于python中inspect模块的一些探究/" itemprop="url">关于python中inspect模块的一些探究</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-06T12:13:30+08:00">
                2016-11-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>我在学习到<a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/001432339008728d0ddbe19ee594980be3f0644a9371894000" target="_blank" rel="external">实战Day5 - python教程 - 廖雪峰的官方网站</a>时，遇到了inspect模块，之前对这个inspect模块一无所知啊，所以本着打破砂锅问到底的精神，决定对inspect模块做一些探究。</p>
<p>根据度娘搜到的，inspect模块主要提供了四种用处：</p>
<p>(1). 对是否是模块，框架，函数等进行类型检查。</p>
<p>(2). 获取源码</p>
<p>(3). 获取类或函数的参数的信息</p>
<p>(4). 解析堆栈</p>
<p>我在这次课程中，只用到了第三种用处，即获取类或函数的参数的信息，下面我来探究一下。</p>
<h2 id="探究"><a href="#探究" class="headerlink" title="探究"></a>探究</h2><p>结合我正在学习的课程，我自己也对inspect做了一些探究。根据在课程中用到的一些函数及方法，我做了一个python脚本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"># test</div><div class="line">import inspect</div><div class="line">def a(a, b=0, *c, d, e=1, **f):</div><div class="line">    pass</div><div class="line">aa = inspect.signature(a)</div><div class="line">print(&quot;inspect.signature（fn)是:%s&quot; % aa)</div><div class="line">print(&quot;inspect.signature（fn)的类型：%s&quot; % (type(aa)))</div><div class="line">print(&quot;\n&quot;)</div><div class="line"></div><div class="line">bb = aa.parameters</div><div class="line">print(&quot;signature.paramerters属性是:%s&quot; % bb)</div><div class="line">print(&quot;ignature.paramerters属性的类型是%s&quot; % type(bb))</div><div class="line">print(&quot;\n&quot;)</div><div class="line"></div><div class="line">for cc, dd in bb.items():</div><div class="line">    print(&quot;mappingproxy.items()返回的两个值分别是：%s和%s&quot; % (cc, dd))</div><div class="line">    print(&quot;mappingproxy.items()返回的两个值的类型分别是：%s和%s&quot; % (type(cc), type(dd)))</div><div class="line">    print(&quot;\n&quot;)</div><div class="line">    ee = dd.kind</div><div class="line">    print(&quot;Parameter.kind属性是:%s&quot; % ee)</div><div class="line">    print(&quot;Parameter.kind属性的类型是:%s&quot; % type(ee))</div><div class="line">    print(&quot;\n&quot;)</div><div class="line">    gg = dd.default</div><div class="line">    print(&quot;Parameter.default的值是: %s&quot; % gg)</div><div class="line">    print(&quot;Parameter.default的属性是: %s&quot; % type(gg))</div><div class="line">    print(&quot;\n&quot;)</div><div class="line">    </div><div class="line"></div><div class="line">ff = inspect.Parameter.KEYWORD_ONLY</div><div class="line">print(&quot;inspect.Parameter.KEYWORD_ONLY的值是:%s&quot; % ff)</div><div class="line">print(&quot;inspect.Parameter.KEYWORD_ONLY的类型是:%s&quot; % type(ff))</div></pre></td></tr></table></figure></p>
<p>执行以上脚本，将得到如下输出：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line">inspect.signature（fn)是:(a, b=0, *c, d, e=1, **f)</div><div class="line">inspect.signature（fn)的类型：&lt;class &apos;inspect.Signature&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">signature.paramerters属性是:OrderedDict([(&apos;a&apos;, &lt;Parameter &quot;a&quot;&gt;), (&apos;b&apos;, &lt;Parameter &quot;b=0&quot;&gt;), (&apos;c&apos;, &lt;Parameter &quot;*c&quot;&gt;), (&apos;d&apos;, &lt;Parameter &quot;d&quot;&gt;), (&apos;e&apos;, &lt;Parameter &quot;e=1&quot;&gt;), (&apos;f&apos;, &lt;Parameter &quot;**f&quot;&gt;)])</div><div class="line">ignature.paramerters属性的类型是&lt;class &apos;mappingproxy&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：a和a</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:POSITIONAL_OR_KEYWORD</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: &lt;class &apos;inspect._empty&apos;&gt;</div><div class="line">Parameter.default的属性是: &lt;class &apos;type&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：b和b=0</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:POSITIONAL_OR_KEYWORD</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: 0</div><div class="line">Parameter.default的属性是: &lt;class &apos;int&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：c和*c</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:VAR_POSITIONAL</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: &lt;class &apos;inspect._empty&apos;&gt;</div><div class="line">Parameter.default的属性是: &lt;class &apos;type&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：d和d</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:KEYWORD_ONLY</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: &lt;class &apos;inspect._empty&apos;&gt;</div><div class="line">Parameter.default的属性是: &lt;class &apos;type&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：e和e=1</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:KEYWORD_ONLY</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: 1</div><div class="line">Parameter.default的属性是: &lt;class &apos;int&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">mappingproxy.items()返回的两个值分别是：f和**f</div><div class="line">mappingproxy.items()返回的两个值的类型分别是：&lt;class &apos;str&apos;&gt;和&lt;class &apos;inspect.Parameter&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.kind属性是:VAR_KEYWORD</div><div class="line">Parameter.kind属性的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">Parameter.default的值是: &lt;class &apos;inspect._empty&apos;&gt;</div><div class="line">Parameter.default的属性是: &lt;class &apos;type&apos;&gt;</div><div class="line"></div><div class="line"></div><div class="line">inspect.Parameter.KEYWORD_ONLY的值是:KEYWORD_ONLY</div><div class="line">inspect.Parameter.KEYWORD_ONLY的类型是:&lt;enum &apos;_ParameterKind&apos;&gt;</div></pre></td></tr></table></figure></p>
<p>##总结</p>
<ul>
<li><p><code>inspect.signature（fn)</code>将返回一个<code>inspect.Signature</code>类型的对象，值为fn这个函数的所有参数</p>
</li>
<li><p><code>inspect.Signature</code>对象的<code>paramerters</code>属性是一个<code>mappingproxy</code>（映射）类型的对象，值为一个有序字典（Orderdict)。</p>
<ul>
<li><p>这个字典里的key是即为参数名，<code>str</code>类型</p>
</li>
<li><p>这个字典里的value是一个<code>inspect.Parameter</code>类型的对象，根据我的理解，这个对象里包含的一个参数的各种信息</p>
</li>
</ul>
</li>
<li><p><code>inspect.Parameter</code>对象的<code>kind</code>属性是一个<code>_ParameterKind</code>枚举类型的对象，值为这个参数的类型（可变参数，关键词参数，etc）</p>
</li>
<li><p><code>inspect.Parameter</code>对象的<code>default</code>属性：如果这个参数有默认值，即返回这个默认值，如果没有，返回一个<code>inspect._empty</code>类。</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2016/10/31/python中的元类Metaclass/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/31/python中的元类Metaclass/" itemprop="url">python中的元类Metaclass</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-31T20:18:42+08:00">
                2016-10-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="理解元类之前需要学习的知识"><a href="#理解元类之前需要学习的知识" class="headerlink" title="理解元类之前需要学习的知识"></a>理解元类之前需要学习的知识</h2><p> 如果说让我们创建一个类，最先想到的肯定是用<code>class</code>创建，当我们使用<code>class</code>创建类的时候，python解释器自动创建这个对象，但是python同样也提供了手动处理的方法来创建类，这就是用python的自建函数<code>type()</code>。</p>
<p> 我们所熟知的<code>type()</code>函数的作用是返回一个参数的类型，但是实际上，它也有一种完全不同的能力，即接受一个类的一些描述作为参数，然后返回一个类。</p>
<p> <code>type()</code>函数的语法是这样的:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">type(类名, 父类的元组（针对继承的情况，可以为空），包含属性的字典（名称和值）)</div></pre></td></tr></table></figure></p>
<p>举个例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class ReedSun(ShuaiGe):</div><div class="line">    shuai = True</div><div class="line">    def test(x):</div><div class="line">        return x+2</div><div class="line"># 就等价于</div><div class="line">type(&quot;ReedSun&quot;, (ShuaiGe,), &#123;&quot;shuai&quot;:True, &quot;test&quot;:lambda x: x+2&#125;)</div><div class="line"># （属性和方法本质上都是方法）</div></pre></td></tr></table></figure></p>
<p>在python中，类也是对象，当我们使用class关键词创建一个类的时候，Python解释器仅仅是扫描一下class定义的语法，然后调用<code>type()</code>函数创建出class。</p>
<h2 id="元类是什么"><a href="#元类是什么" class="headerlink" title="元类是什么"></a>元类是什么</h2><p>元类是什么？元类实际上就是用来创建类的东西。为了帮助我们理解，我们可以这样想，我们创建类就是为了创建类的实例，同样的，我们创建元类就是为了创建类。元类就是类<em>（实例）</em>的类，就像下面这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Metaclass() = class</div><div class="line">class() = object  # object==&gt;实例</div></pre></td></tr></table></figure></p>
<p>理解了什么是元类，我们再来看一看type()函数。</p>
<p>其实type就是一个元类，type就是我们用来创建所有的类的元类。（如果我们要创建自己定义的元类的话，也要从type中继承）</p>
<h2 id="元类的工作原理"><a href="#元类的工作原理" class="headerlink" title="元类的工作原理"></a>元类的工作原理</h2><p>我们来看一下下面这个例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">class ReedSunMetaclass(type):</div><div class="line">    pass</div><div class="line">    </div><div class="line">class Foo(object， metaclass = ReedSunMetaclass): </div><div class="line">    pass</div><div class="line">    </div><div class="line">class Bar(Foo):</div><div class="line">    pass</div></pre></td></tr></table></figure></p>
<ol>
<li><p>首先，我们创建了一个元类<code>ReedSunMetaclass</code><em>（注意！按照默认习惯，元类的类名总是以<code>Metaclass</code>结尾，以便清楚地表示这是一个元类）</em>。</p>
</li>
<li><p>然后，我们又用元类<code>ReedSunMetaclass</code>创建了一个<code>Foo</code>类，<em>（同时，<code>Foo</code>类的属性<code>__metaclass__</code>就变成了<code>ReedSunMetaclass</code>)</em>。</p>
</li>
<li><p>最后，我们创建了一个子类<code>Bar</code>继承自<code>Foo</code>。</p>
</li>
</ol>
<p>我们来试着理解一下在python内部是怎么执行这几个步骤的：</p>
<ul>
<li><p>对于父类<code>Foo</code>，Python会在类的定义中寻找<code>__metaclass__</code>属性，如果找到了，Python就会用它来创建类<code>Foo</code>，如果没有找到，就会用内建的type来创建这个类。很显然，它找到了。</p>
</li>
<li><p>对于子类<code>Bar</code>, python会先在子类中寻找<code>__metaclass__</code>属性，如果找到了，Python就会用它来创建类<code>Bar</code>，如果没有找到，就再从父类中寻找，直到type。显然，它在父类中找到了。</p>
</li>
</ul>
<p><strong>我们可以看到使用元类的一个好处了，即他可以让子类隐式的继承一些东西。</strong></p>
<h2 id="自定义元类"><a href="#自定义元类" class="headerlink" title="自定义元类"></a>自定义元类</h2><p>元类的主要目的就是为了当创建类时能够自动地改变类。创建类我们需要定义<code>__new__()</code>函数，<code>__new__</code> 是在<code>__init__</code>之前被调用的特殊方法，是用来创建对象并返回之的方法。我们举个例子来说明定义自定义元类的方法。</p>
<p><code>__new__()</code>方法接收到的参数依次是：</p>
<ol>
<li>当前准备创建的类的对象；</li>
<li>类的名字；</li>
<li>类继承的父类集合；</li>
<li>类的方法集合。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">class ReedSunMetaclass(type):</div><div class="line">    def __new__(cls, name, bases, attrs):</div><div class="line">        # 添加一个属性</div><div class="line">        attrs[&apos;哈哈哈&apos;] = True</div><div class="line">        return type.__new__(cls, name, bases, attrs)</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="我们用一个实际例子来说明元类的用法"><a href="#我们用一个实际例子来说明元类的用法" class="headerlink" title="我们用一个实际例子来说明元类的用法"></a>我们用一个实际例子来说明元类的用法</h2><p><code>ORM</code>就是一个典型的使用元类的例子。<code>ORM</code>全称“Object Relational Mapping”，即对象-关系映射，就是把关系数据库的一行映射为一个对象，也就是一个类对应一个表，这样，写代码更简单，不用直接操作SQL语句。下面我就用这个<code>ORM</code>的例子来说明一下元类的用法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div></pre></td><td class="code"><pre><div class="line">#ORM:object relational mapping 对象-关系映射</div><div class="line">#把关系数据库的一行映射为一个对象，也就是一个类对应一个表</div><div class="line">#ORM框架所有的类只能动态定义</div><div class="line"></div><div class="line"></div><div class="line"># 定义Field(定义域：元类遇到Field的方法或属性时即进行修改）</div><div class="line">class Field(object):</div><div class="line"></div><div class="line">    def __init__(self, name, column_type):  # column==&gt;列类型</div><div class="line">        self.name = name</div><div class="line">        self.column_type = column_type</div><div class="line"></div><div class="line">    # 当用print打印输出的时候，python会调用他的str方法</div><div class="line">    # 在这里是输出&lt;类的名字，实例的name参数(定义实例时输入)&gt;</div><div class="line">    # 在ModelMetaclass中会用到</div><div class="line">    def __str__(self):</div><div class="line">        return &quot;&lt;%s:%s&gt;&quot; % (self.__class__.__name__, self. name)  # __class__获取对象的类，__name__取得类名</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># 进一步定义各种类型的Field</div><div class="line">class StringField(Field):</div><div class="line"></div><div class="line">    def __init__(self, name):</div><div class="line">        # super(type[, object-or-type])  返回type的父类对象</div><div class="line">        # super().__init()的作用是调用父类的init函数</div><div class="line">        # varchar(100)和bigint都是sql中的一些数据类型</div><div class="line">        super(StringField, self).__init__(name, &quot;varchar(100)&quot;)  </div><div class="line"></div><div class="line">class IntegerField(Field):</div><div class="line"></div><div class="line">    def __init__(self, name):</div><div class="line">        super(IntegerField, self).__init__(name, &quot;bigint&quot;)</div><div class="line"></div><div class="line"></div><div class="line"># 编写ModelMetaclass</div><div class="line">class ModelMetaclass(type):</div><div class="line">    </div><div class="line">    # __new__方法接受的参数依次是：</div><div class="line">    # 1.当前准备创建的类的对象（cls）</div><div class="line">    # 2.类的名字（name）</div><div class="line">    # 3.类继承的父类集合(bases)</div><div class="line">    # 4.类的方法集合(attrs)</div><div class="line">    def __new__(cls, name, bases, attrs):</div><div class="line">        # 如果说新创建的类的名字是Model，那直接返回不做修改</div><div class="line">        if name == &quot;Model&quot;:</div><div class="line">            return type.__new__(cls, name, bases, attrs)</div><div class="line">        print(&quot;Found model:%s&quot; % name)</div><div class="line">        mappings = dict()</div><div class="line">        for k, v in attrs.items():</div><div class="line">            if isinstance(v, Field):</div><div class="line">                print(&quot;Found mappings:%s ==&gt; %s&quot; % (k, v))  # 找到映射， 这里用到上面的__str__</div><div class="line">                mappings[k] = v</div><div class="line">            # 结合之前，即把之前在方法集合中的零散的映射删除，</div><div class="line">            # 把它们从方法集合中挑出，组成一个大方法__mappings__</div><div class="line">            # 把__mappings__添加到方法集合attrs中</div><div class="line">        for k in mappings.keys():</div><div class="line">                attrs.pop(k)</div><div class="line">        attrs[&quot;__mappings__&quot;] = mappings</div><div class="line">        attrs[&quot;__table__&quot;] = name # 添加表名，假设表名与类名一致</div><div class="line">        return type.__new__(cls, name, bases, attrs)</div><div class="line"></div><div class="line"></div><div class="line"># 编写Model基类继承自dict中，这样可以使用一些dict的方法</div><div class="line">class Model(dict, metaclass=ModelMetaclass):</div><div class="line"></div><div class="line">    def __init__(self,  **kw):</div><div class="line">        # 调用父类，即dict的初始化方法</div><div class="line">        super(Model, self).__init__(**kw)</div><div class="line"></div><div class="line">    # 让获取key的值不仅仅可以d[k]，也可以d.k</div><div class="line">    def __getattr__(self, key):</div><div class="line">        try:</div><div class="line">            return self[key]</div><div class="line">        except KeyError:</div><div class="line">            raise AttributeError(r&quot;&apos;Model&apos; object has no attribute &apos;%s&apos;&quot; % key)</div><div class="line"></div><div class="line">    # 允许动态设置key的值，不仅仅可以d[k]，也可以d.k</div><div class="line">    def __setattr__(self, key, value):</div><div class="line">        self[key] = value</div><div class="line"></div><div class="line">    def save(self):</div><div class="line">        fields = []</div><div class="line">        params = []</div><div class="line">        args = []</div><div class="line">        # 在所有映射中迭代</div><div class="line">        for k, v in self.__mappings__.items():</div><div class="line">            fields.append(v.name)</div><div class="line">            params.append(&quot;?&quot;)</div><div class="line">            args.append(getattr(self, k, None))</div><div class="line">        sql = &quot;insert into %s (%s) values (%s)&quot; % (self.__table__, &quot;,&quot;.join(fields), &quot;,&quot;.join(params))</div><div class="line">        print(&quot;SQL: %s&quot; % sql)</div><div class="line">        print(&quot;ARGS: %s&quot; % str(args))</div><div class="line"></div><div class="line"></div><div class="line"># 这样一个简单的ORM就写完了</div><div class="line"></div><div class="line"></div><div class="line"># 下面实际操作一下，先定义个User类来对应数据库的表User</div><div class="line">class User(Model):</div><div class="line">    # 定义类的属性到列的映射</div><div class="line">    id = IntegerField(&quot;id&quot;)</div><div class="line">    name = StringField(&quot;username&quot;)</div><div class="line">    email = StringField(&quot;email&quot;)</div><div class="line">    password = StringField(&quot;password&quot;)</div><div class="line"></div><div class="line"></div><div class="line"># 创建一个实例</div><div class="line">u = User(id=12345, name=&quot;ReedSun&quot;, email=&quot;sunhongzhao@foxmail.com&quot;, password=&quot;nicaicai&quot;)</div><div class="line">u.save()</div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol>
<li><a href="http://www.liaoxuefeng.com/wiki/0014316089557264a6b348958f449949df42a6d3a2e542c000/0014319106919344c4ef8b1e04c48778bb45796e0335839000" target="_blank" rel="external">使用元类-廖雪峰的官方网站</a></li>
<li><a href="http://blog.jobbole.com/21351/" target="_blank" rel="external">深刻理解python中的元类</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2016/10/21/使用python的email、smtplib、poplib模块收发邮件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/21/使用python的email、smtplib、poplib模块收发邮件/" itemprop="url">使用python的email、smtplib、poplib模块收发邮件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-21T10:53:32+08:00">
                2016-10-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>一封电子邮件的旅程是：<ul>
<li>MUA：Mail User Agent——邮件用户代理。(即类似Outlook的电子邮件软件）</li>
<li>MTA：Mail Transfer Agent——邮件传输代理，就是那些Email服务提供商，比如网易、新浪等等。</li>
<li>MDA：Mail Delivery Agent——邮件投递代理。Email服务提供商的某个服务器</li>
</ul>
</li>
</ul>
<blockquote>
<p>发件人 -&gt; MUA -&gt; MTA -&gt; MTA -&gt; 若干个MTA -&gt; MDA &lt;- MUA &lt;- 收件人</p>
</blockquote>
<ul>
<li><p>要编写程序来发送和接收邮件，本质上就是：</p>
<ul>
<li><p>编写MUA把邮件发到MTA；</p>
</li>
<li><p>编写MUA从MDA上收邮件。</p>
</li>
</ul>
</li>
<li><p>发邮件时，MUA和MTA使用的协议就是SMTP：Simple Mail Transfer Protocol，后面的MTA到另一个MTA也是用SMTP协议。</p>
</li>
<li>收邮件时，MUA和MDA使用的协议有两种：POP：Post Office Protocol，目前版本是3，俗称POP3；IMAP：Internet Message Access Protocol，目前版本是4，优点是不但能取邮件，还可以直接操作MDA上存储的邮件，比如从收件箱移到垃圾箱，等等。</li>
</ul>
<ul>
<li>构造一个邮件对象就是一个Messag对象，如果构造一个MIMEText对象，就表示一个文本邮件对象，如果构造一个MIMEImage对象，就表示一个作为附件的图片，要把多个对象组合起来，就用MIMEMultipart对象，而MIMEBase可以表示任何对象。它们的继承关系如下：</li>
</ul>
<blockquote>
<p>Message</p>
<blockquote>
<p>+- MIMEBase</p>
<blockquote>
<p>  +- MIMEMultipart<br>      +- MIMENonMultipart</p>
<blockquote>
<pre><code>+- MIMEMessage
 +- MIMEText
 +- MIMEImage
</code></pre></blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>##发送邮件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">from email.mime.text import MIMEText</div><div class="line"># email模块负责构造邮件</div><div class="line"># 类email.mime.text.MIMEText(_text)，是使用字符串_text来生成MIME对象的主体文本</div><div class="line"># MIME是(Multipurpose Internet Mail Extensions) 多用途互联网邮件扩展类型</div><div class="line"># MIME是设置将某种扩展名文件用一种应用程序来打开的方式类型</div><div class="line"># MIME设置的目的是为了在发送电子邮件时附加多媒体数据，让邮件根据其类型进行处理。</div><div class="line"></div><div class="line"></div><div class="line">import smtplib</div><div class="line"># smtplib模块负责发送邮件</div><div class="line"># 类smtplib.SMTP([host[, port[, local_hostname[, timeout]]]]) ：SMTP对象</div><div class="line">    # 其中，host：smtp服务器主机名</div><div class="line">    # 其中，port：smtp服务器的端口，默认是25</div><div class="line"># 如果在创建SMTP对象时定义了这两个参数，在初始化时会自动调用connect方式连接服务器</div><div class="line"># smtplib模块还提供了SMTP_SSL类和LMTP类，对它们的操作与SMTP基本一致。</div><div class="line"># SSL是一种安全传输，LMTP是与SMTP不同的另一种传输协议</div><div class="line"></div><div class="line"></div><div class="line">from email.header import Header</div><div class="line"># 如果你想让你的邮件标题使用非ASCII字符集，就要使用email.header编码非ASCII字符集</div><div class="line"># email.header.Header(s=None, charset=None, maxlinelen=None, header_name=None, continuation_ws=&apos; &apos;, errors=&apos;strict&apos;)</div><div class="line">    # 创建一个能容纳不同字符集的字符串的MIME对象的标头</div><div class="line">    # 其中，s：初始标头，即要编码之前的标头</div><div class="line">    # 其中，chatset：字符集，默认为ASCII</div><div class="line">    # 其中，maxlinelen：标头名的行的最大长度，默认为76</div><div class="line">    # 其中，header_name：标头名，默认无</div><div class="line">    # 其中，continuation_ws：默认为单个空格字符</div><div class="line">    # 其中，errors：直接传递到Header的append()方法里</div><div class="line"></div><div class="line"></div><div class="line">from email.utils import parseaddr, formataddr</div><div class="line"># email.utils:杂项工具</div><div class="line"># email.utils.parseaddr(address):解析地址的功能，</div><div class="line">    # 其中，address是一个包含用户名和email地址的值（realname&lt;address&gt;），返回一个二元组(realname, email address)</div><div class="line"># email.utils.formataddr(pair, charset=&apos;utf-8&apos;)</div><div class="line">    # 其中，pair是二元组(realname, email address)</div><div class="line">    # 其中，charset是字符串，默认为utf-8</div><div class="line"># 实际上，parseaddr(), formataddr(),两者互逆</div><div class="line"></div><div class="line"></div><div class="line">from email.mime.base import MIMEBase</div><div class="line"># email.mime.base.MIMEBase(_maintype, _subtype, **_params)</div><div class="line">    # 这是MIME的一个基类。一般不需要在使用时创建实例。</div><div class="line">    # 其中_maintype是内容类型，如text或者image。</div><div class="line">    # _subtype是内容的minor type 类型，如plain或者gif。</div><div class="line">    # **_params是一个字典，直接传递给Message.add_header()。</div><div class="line"></div><div class="line"></div><div class="line">from email.mime.multipart import MIMEMultipart</div><div class="line"># email.mime.multipart.MIMEMultipart(_subtype=&apos;mixed&apos;, boundary=None, _subparts=None, **_params)</div><div class="line">    # MIMEMultipart是MIMEBase的一个子类，多个MIME对象的集合</div><div class="line">    # _subtype默认值为mixed。boundary是MIMEMultipart的边界，默认边界是可数的。</div><div class="line"></div><div class="line"></div><div class="line">from email import encoders</div><div class="line"># email.encoders 功能是编码器</div><div class="line"></div><div class="line"></div><div class="line">def _format_addr(s):</div><div class="line"># 这个函数的作用是把一个标头的用户名编码成utf-8格式的，如果不编码原标头中文用户名，用户名将无法被邮件解码</div><div class="line">    name, addr = parseaddr(s)</div><div class="line">    return formataddr((Header(name, &quot;utf-8&quot;).encode(), addr))</div><div class="line">    # Header().encode(splitchars=&apos;;, \t&apos;, maxlinelen=None, linesep=&apos;\n&apos;)</div><div class="line">        # 功能：编码一个邮件标头，使之变成一个RFC兼容的格式</div><div class="line"></div><div class="line"></div><div class="line"># 先定义Email的地址，口令和SMTP服务器地址</div><div class="line">from_addr = &quot;947503956@qq.com&quot;</div><div class="line">password = input(&quot;请输入发送邮箱的密码:&quot;)</div><div class="line">to_addr = &quot;sunwstmz@163.com&quot;</div><div class="line">smtp_server = &quot;smtp.qq.com&quot;</div><div class="line"></div><div class="line"></div><div class="line"># 接下来定义邮件本身的内容</div><div class="line">msg = MIMEMultipart()</div><div class="line">msg[&quot;From&quot;] = _format_addr(&quot;发送者ReedSun &lt;%s&gt;&quot; % from_addr)</div><div class="line">msg[&quot;To&quot;] = _format_addr(&quot;接收者ReedSun &lt;%s&gt;&quot; % to_addr)</div><div class="line">msg[&quot;Subject&quot;] = Header(&quot;哈哈哈 这是一封测试信&quot;, &quot;utf-8&quot;).encode()</div><div class="line"># 定义邮件正文</div><div class="line">msg.attach(MIMEText(&quot;这是一封来自大魔王ReedSun，用Python发来的邮件&quot;, &quot;plain&quot;, &quot;utf-8&quot;))</div><div class="line"># class email.mime.text.MIMEText(_text[, _subtype[, _charset]])：MIME文本对象，</div><div class="line">    # 其中, _text是邮件内容，</div><div class="line">    # 其中, _subtype邮件类型(MIME类型)，可以是text/plain（普通文本邮件），html/plain(html邮件),</div><div class="line">    # 其中, _charset编码（charset：字符集），可以是gb2312等等。</div><div class="line"># message.attch(payload) 将给定的附件或信息，添加到已有的有效附件或信息中，在调用之前必须是None或者List，调用后。payload将变成信息对象的列表</div><div class="line"># 如果你想将payload设置成一个标量对象，要使用set_payload()</div><div class="line">with open(&apos;c:/work/test.jpg&apos;, &apos;rb&apos;) as f:</div><div class="line">    mime = MIMEBase(&quot;image&quot;, &quot;jpg&quot;, filename=&quot;test.jpg&quot;)</div><div class="line">    mime.add_header(&quot;Content-Disposition&quot;, &quot;attchment&quot;, filename=&quot;test.jpg&quot;)</div><div class="line">    # add_header(_name, _value, **_params) 扩展标头设置</div><div class="line">        # _name：要添加的标头字段</div><div class="line">        # _value：标头的内容</div><div class="line">    # Content-Disposition就是当用户想把请求所得的内容存为一个文件的时候提供一个默认的文件名。</div><div class="line">        # 希望某类或者某已知MIME 类型的文件（比如：*.gif;*.txt;*.htm）能够在访问时弹出“文件下载”对话框。</div><div class="line">    mime.add_header(&quot;Content-ID&quot;, &quot;&lt;0&gt;&quot;)</div><div class="line">    mime.add_header(&quot;X-Attachment-Id&quot;, &quot;0&quot;)</div><div class="line">    mime.set_payload(f.read())</div><div class="line">    # set_payload(payload, charset=None)</div><div class="line">        # 将附件添加到payload中</div><div class="line">    encoders.encode_base64(mime)</div><div class="line">    # encoders.encode_base64(mime) 将payload内容编码为base64格式</div><div class="line">    msg.attach(mime)</div><div class="line"></div><div class="line"></div><div class="line"># 接下来定义发送文件</div><div class="line">server = smtplib.SMTP_SSL(smtp_server, 465)</div><div class="line"># qq邮箱使用SSL连接，端口为465</div><div class="line">server.set_debuglevel(1)</div><div class="line"># SMTP.set_debuglevel(level)：设置是否为调试模式。默认为False，即非调试模式，</div><div class="line"># 非调试模式：表示不输出任何调试信息。</div><div class="line">server.login(from_addr, password)</div><div class="line"># 登陆到smtp服务器。</div><div class="line"># 现在几乎所有的smtp服务器，都必须在验证用户信息合法之后才允许发送邮件。</div><div class="line">server.sendmail(from_addr, [to_addr], msg.as_string())</div><div class="line"># SMTP.sendmail(from_addr, to_addrs, msg[, mail_options, rcpt_options]) ：发送邮件。</div><div class="line"># 这里要注意一下第三个参数，msg是字符串，表示邮件。</div><div class="line"># 我们知道邮件一般由标题，发信人，收件人，邮件内容，附件等构成，</div><div class="line"># 发送邮件的时候，要注意msg的格式。这个格式就是smtp协议中定义的格式。</div><div class="line"># 第二个参数，接受邮箱为一个列表，表示可以设置多个接受邮箱</div><div class="line"># as_string()是MIMEMessage对象的一个方法，表示把MIMETest对象变成str</div><div class="line">server.quit()</div><div class="line"># 断开与smtp服务器的连接，相当于发送&quot;quit&quot;指令。</div></pre></td></tr></table></figure></p>
<p>##接受邮件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line">from email.parser import Parser</div><div class="line"># email.parser 解析电子邮件</div><div class="line">    # 返回这个对象的email.message.Message实例</div><div class="line">from email.header import decode_header</div><div class="line">from email.utils import parseaddr</div><div class="line">import poplib</div><div class="line"></div><div class="line"></div><div class="line">email = &quot;947503956@qq.com&quot;</div><div class="line">password = input(&quot;密码:&quot;)</div><div class="line">pop3_server = &quot;pop.qq.com&quot;</div><div class="line"></div><div class="line"># 连接到POP3服务器</div><div class="line">server = poplib.POP3_SSL(pop3_server)</div><div class="line"># 注意qq邮箱使用SSL连接</div><div class="line"># 打开调试信息</div><div class="line">server.set_debuglevel(1)</div><div class="line"># 打印POP3服务器的欢迎文字</div><div class="line">print(server.getwelcome().decode(&quot;utf-8&quot;))</div><div class="line"></div><div class="line"># 身份认证</div><div class="line">server.user(email)</div><div class="line">server.pass_(password)</div><div class="line"></div><div class="line"># stat()返回邮件数量和占用空间</div><div class="line">print(&quot;信息数量：%s 占用空间 %s&quot; % server.stat())</div><div class="line"># list()返回(response, [&apos;mesg_num octets&apos;, ...], octets)，第二项是编号</div><div class="line">resp, mails, octets = server.list()</div><div class="line">print(&quot;list!!!!&quot;,server.list())</div><div class="line"># 返回的列表类似[b&apos;1 82923&apos;, b&apos;2 2184&apos;, ...]</div><div class="line">print(mails)</div><div class="line"></div><div class="line"># 获取最新一封邮件，注意索引号从1开始</div><div class="line"># POP3.retr(which) 检索序号which的真个消息，然后设置他的出现标志 返回(response, [&apos;line&apos;, ...], octets)这个三元组</div><div class="line">index = len(mails)</div><div class="line">resp, lines, ocetes = server.retr(index)</div><div class="line"></div><div class="line"># lines 存储了邮件的原始文本的每一行</div><div class="line"># 可以获得整个邮件的原始文本</div><div class="line">msg_content = b&quot;\r\n&quot;.join(lines).decode(&quot;utf-8&quot;)</div><div class="line"># 稍后解析出邮件</div><div class="line">msg = Parser().parsestr(msg_content)</div><div class="line"># email.Parser.parsestr(text, headersonly=False)</div><div class="line">    # 与parser()方法类似，不同的是他接受一个字符串对象而不是一个类似文件的对象</div><div class="line">    # 可选的headersonly表示是否在解析玩标题后停止解析，默认为否</div><div class="line">    # 返回根消息对象</div><div class="line"></div><div class="line"># 关闭连接</div><div class="line">server.quit()</div><div class="line"></div><div class="line"></div><div class="line">#### 解析邮件</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># 邮件的Subject或者Email中包含的名字都是经过编码后的str，要正常显示，就必须decode</div><div class="line">def decode_str(s):</div><div class="line">    value, charset = decode_header(s)[0]</div><div class="line">    # decode_header()返回一个list，因为像Cc、Bcc这样的字段可能包含多个邮件地址，所以解析出来的会有多个元素。上面的代码我们偷了个懒，只取了第一个元素。</div><div class="line">    if charset:</div><div class="line">        value = value.decode(charset)</div><div class="line">    return value</div><div class="line"></div><div class="line"></div><div class="line"># 文本邮件的内容也是str，还需要检测编码，否则，非UTF-8编码的邮件都无法正常显示</div><div class="line">def guess_charset(msg):</div><div class="line">    charset = msg.get_charset()</div><div class="line">    if charset is None:</div><div class="line">        content_type = msg.get(&apos;Content-Type&apos;, &apos;&apos;).lower()</div><div class="line">        pos = content_type.find(&apos;charset=&apos;)</div><div class="line">        if pos &gt;= 0:</div><div class="line">            charset = content_type[pos + 8:].strip()</div><div class="line">    return charset</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"># 解析邮件与构造邮件的步骤正好相反</div><div class="line">def print_info(msg, indent=0):</div><div class="line">    if indent ==0:</div><div class="line">        for header in [&quot;From&quot;, &quot;To&quot;, &quot;Subject&quot;]:</div><div class="line">            value = msg.get(header, &quot;&quot;)</div><div class="line">            if value:</div><div class="line">                if header == &quot;Subject&quot;:</div><div class="line">                    vaule = decode_str(value)</div><div class="line">                else:</div><div class="line">                    hdr, addr =parseaddr(value)</div><div class="line">                    name = decode_str(hdr)</div><div class="line">                    value = u&quot;%s &lt;%s&gt;&quot; % (name, addr)</div><div class="line">            print(&quot;%s%s:%s&quot; % (&quot;  &quot; * indent, header, value))</div><div class="line">        if (msg .is_multipart()):</div><div class="line">            parts = msg.get_payload()</div><div class="line">            for n, part in enumerate(parts):</div><div class="line">                print(&apos;%spart %s&apos; % (&apos;  &apos; * indent, n))</div><div class="line">                print(&apos;%s--------------------&apos; % (&apos;  &apos; * indent))</div><div class="line">                print_info(part, indent + 1)</div><div class="line">        else:</div><div class="line">            content_type = msg.get_content_type()</div><div class="line">            if content_type==&apos;text/plain&apos; or content_type==&apos;text/html&apos;:</div><div class="line">                content = msg.get_payload(decode=True)</div><div class="line">                charset = guess_charset(msg)</div><div class="line">                if charset:</div><div class="line">                    content = content.decode(charset)</div><div class="line">                print(&apos;%sText: %s&apos; % (&apos;  &apos; * indent, content + &apos;...&apos;))</div><div class="line">            else:</div><div class="line">                print(&apos;%sAttachment: %s&apos; % (&apos;  &apos; * indent, content_type))</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2016/10/17/学习urblib和requests/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/17/学习urblib和requests/" itemprop="url">学习urblib和requests</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-17T21:12:36+08:00">
                2016-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="学习urblib和requests"><a href="#学习urblib和requests" class="headerlink" title="学习urblib和requests"></a>学习urblib和requests</h1><ul>
<li><p>urblib是python的一个自建模块，它提供了一系列用于操作URL的功能。</p>
</li>
<li><p>而第三方模块requests是对urllib的人性化封装。</p>
</li>
</ul>
<p>##requests</p>
<ul>
<li><a href="http://cn.python-requests.org/zh_CN/latest/" target="_blank" rel="external">中文官方文档</a></li>
<li><a href="http://cn.python-requests.org/zh_CN/latest/user/quickstart.html" target="_blank" rel="external">快速上手</a></li>
</ul>
<p>##urllib</p>
<ul>
<li><p>urllib是基于http的高层库，它有以下三个主要功能：</p>
<ul>
<li>request处理客户端的请求</li>
<li>response处理服务端的响应</li>
<li>parse会解析url</li>
</ul>
</li>
<li><p>下面是使用Python3中urllib来获取资源的一些示例</p>
<ul>
<li><p>最简单的抓取url内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> import urllib.request  </div><div class="line">response = urllib.request.urlopen(&apos;http://python.org/&apos;)  </div><div class="line">html = response.read()</div></pre></td></tr></table></figure>
</li>
<li><p>使用response处理服务器的相应。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> import urllib.request  </div><div class="line">req = urllib.request.Request(&apos;http://python.org/&apos;)  </div><div class="line">response = urllib.request.urlopen(req)  </div><div class="line">the_page = response.read()</div></pre></td></tr></table></figure>
</li>
<li><p>发送数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line">url = &apos;&quot;  </div><div class="line">values = &#123;  </div><div class="line">&apos;act&apos; : &apos;login&apos;,  </div><div class="line">&apos;login[email]&apos; : &apos;&apos;,  </div><div class="line">&apos;login[password]&apos; : &apos;&apos;  </div><div class="line">&#125;  </div><div class="line">data = urllib.parse.urlencode(values)  </div><div class="line">req = urllib.request.Request(url, data)  </div><div class="line">req.add_header(&apos;Referer&apos;, &apos;http://www.python.org/&apos;)  </div><div class="line">response = urllib.request.urlopen(req)  </div><div class="line">the_page = response.read()  </div><div class="line">print(the_page.decode(&quot;utf8&quot;))</div></pre></td></tr></table></figure>
</li>
<li><p>发送数据和header</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"> import urllib.parse  </div><div class="line">import urllib.request  </div><div class="line">url = &apos;&apos;  </div><div class="line">user_agent = &apos;Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)&apos;  </div><div class="line">values = &#123;  </div><div class="line">&apos;act&apos; : &apos;login&apos;,  </div><div class="line">&apos;login[email]&apos; : &apos;&apos;,  </div><div class="line">&apos;login[password]&apos; : &apos;&apos;  </div><div class="line">&#125;  </div><div class="line">headers = &#123; &apos;User-Agent&apos; : user_agent &#125;  </div><div class="line">data = urllib.parse.urlencode(values)  </div><div class="line">req = urllib.request.Request(url, data, headers)  </div><div class="line">response = urllib.request.urlopen(req)  </div><div class="line">the_page = response.read()  </div><div class="line">print(the_page.decode(&quot;utf8&quot;))</div></pre></td></tr></table></figure>
</li>
<li><p>处理http 错误  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">import urllib.request  </div><div class="line">req = urllib.request.Request(&apos; &apos;)  </div><div class="line">try:  </div><div class="line">       urllib.request.urlopen(req)  </div><div class="line">except urllib.error.HTTPError as e:  </div><div class="line">       print(e.code)  </div><div class="line">       print(e.read().decode(&quot;utf8&quot;))</div></pre></td></tr></table></figure>
</li>
<li><p>异常处理1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> from urllib.request import Request, urlopen  </div><div class="line"> from urllib.error import URLError, HTTPError  </div><div class="line"> req = Request(&quot;http://www..net /&quot;)  </div><div class="line"> try:  </div><div class="line">        response = urlopen(req)  </div><div class="line"> except HTTPError as e:  </div><div class="line">        print(&apos;The server couldn&apos;t fulfill the request.&apos;)  </div><div class="line">        print(&apos;Error code: &apos;, e.code)  </div><div class="line"> except URLError as e:  </div><div class="line">        print(&apos;We failed to reach a server.&apos;)  </div><div class="line">        print(&apos;Reason: &apos;, e.reason)  </div><div class="line">else:  </div><div class="line">        print(&quot;good!&quot;)  </div><div class="line">        print(response.read().decode(&quot;utf8&quot;))</div></pre></td></tr></table></figure>
</li>
<li><p>异常处理2  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">from urllib.request import Request, urlopen  </div><div class="line"> from urllib.error import  URLError  </div><div class="line"> req = Request(&quot;http://www.Python.org/&quot;)  </div><div class="line">try:  </div><div class="line">       response = urlopen(req)  </div><div class="line">except URLError as e:  </div><div class="line">       if hasattr(e, &apos;reason&apos;):  </div><div class="line">           print(&apos;We failed to reach a server.&apos;)  </div><div class="line">           print(&apos;Reason: &apos;, e.reason)  </div><div class="line">elif hasattr(e, &apos;code&apos;):  </div><div class="line">       print(&apos;The server couldn&apos;t fulfill the request.&apos;)  </div><div class="line">       print(&apos;Error code: &apos;, e.code)  </div><div class="line">else:  </div><div class="line">       print(&quot;good!&quot;)  </div><div class="line">       print(response.read().decode(&quot;utf8&quot;))</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://reedsun.top/2016/10/17/学习笔记_常用内建模块/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ReedSun">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Preeminent">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/10/17/学习笔记_常用内建模块/" itemprop="url">学习笔记_常用内建模块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-17T21:12:36+08:00">
                2016-10-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>Python之所以自称“batteries included”(自备全套工具），就是因为内置了许多非常有用的模块，无需额外安装和配置，即可直接使用。</p>
</li>
<li><p>本章介绍了一些常用的内建模块，下面总结一下他们。</p>
</li>
</ul>
<h2 id="datatime"><a href="#datatime" class="headerlink" title="datatime"></a>datatime</h2><ul>
<li><p><code>datetime</code>是Python处理日期和时间的标准库。</p>
</li>
<li><p><code>datetime</code>表示的时间需要时区信息才能确定一个特定的时间，否则只能视为本地时间。</p>
</li>
<li><p>如果要存储<code>datetime</code>，最佳方法是将其转换为<code>timestamp</code>再存储，因为<code>timestamp</code>的值与时区完全无关。</p>
</li>
</ul>
<h2 id="collections"><a href="#collections" class="headerlink" title="collections"></a>collections</h2><ul>
<li><p>collections是Python内建的一个<strong>集合</strong>模块，提供了许多有用的<strong>集合</strong>类。</p>
<ul>
<li><p><strong><code>namedtuple</code></strong>→<code>namedtuple</code>是一个函数，它用来创建一个自定义的<code>tuple</code>对象，并且规定了<code>tupl</code>e元素的个数，并可以用属性而不是索引来引用<code>tuple</code>的某个元素。</p>
</li>
<li><p><strong><code>deque</code></strong>→<code>deque</code>是为了高效实现插入和删除操作的双向列表，适合用于队列和栈。</p>
</li>
<li><p><strong><code>defaultdict</code></strong>→使用<code>dict</code>时，如果引用的Key不存在，就会抛出<code>KeyError</code>。如果希望key不存在时，返回一个默认值，就可以用<code>defaultdict</code>，除了在Key不存在时返回默认值，<code>defaultdict</code>的其他行为跟dict是完全一样的。</p>
</li>
<li><p><strong><code>OrederedDict</code></strong>→使用<code>dict</code>时，Key是无序的。如果要保持Key的顺序，可以用<code>OrderedDict</code>,<code>OrderedDict</code>的Key会按照插入的顺序排列，不是Key本身排序。</p>
</li>
<li><p><strong><code>Counter</code></strong>→Counter是一个简单的计数器，例如，统计字符出现的个数，<code>Counter</code>实际上也是<code>dict</code>的一个子类。</p>
</li>
</ul>
</li>
</ul>
<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><ul>
<li><p><code>Base64</code>是一种用64个字符来表示任意二进制数据的方法。</p>
</li>
<li><p><code>Base64</code>是一种任意二进制到文本字符串的编码方法，常用于在URL、Cookie、网页中传输少量二进制数据。</p>
</li>
</ul>
<h2 id="struct"><a href="#struct" class="headerlink" title="struct"></a>struct</h2><ul>
<li><code>struct</code>模块是用来来解决<code>bytes</code><em>(以字节为单位，用带b前缀的单引号或双引号表示)</em>和其他二进制数据类型的转换。</li>
</ul>
<h2 id="hashlib"><a href="#hashlib" class="headerlink" title="hashlib"></a>hashlib</h2><ul>
<li><p>Python的<code>hashlib</code>提供了常见的摘要算法，如MD5，SHA1等等。</p>
</li>
<li><p>摘要算法又称哈希算法、散列算法。它通过一个函数，把任意长度的数据转换为一个长度固定的数据串（通常用16进制的字符串表示）。</p>
</li>
<li><p>摘要算法在很多地方都有广泛的应用<strong><em>(储存密码)</em></strong>。要注意摘要算法不是加密算法，不能用于加密（因为无法通过摘要反推明文），只能用于防篡改，但是它的单向计算特性决定了可以在不存储明文口令的情况下验证用户口令。</p>
</li>
</ul>
<h2 id="itertools"><a href="#itertools" class="headerlink" title="itertools"></a>itertools</h2><ul>
<li><p>Python的内建模块<code>itertools</code>提供了非常有用的用于操作迭代对象的函数。</p>
</li>
<li><p><code>itertools</code>模块提供的全部是处理迭代功能的函数，它们的返回值不是<code>list</code>，而是<code>Iterator</code>，只有用<code>for</code>循环迭代的时候才真正计算。</p>
<ul>
<li><p><strong><em><code>count()</code></em></strong>会创建一个无限的迭代器。</p>
</li>
<li><p><strong><em><code>cycle()</code></em></strong>会把传入的一个序列无限重复下去。</p>
</li>
<li><p><strong><em><code>repeat()</code></em></strong>负责把一个元素无限重复下去，如果提供第二个参数就可以限定重复次数。</p>
</li>
<li><p><strong><em><code>chain()</code></em></strong>可以把一组迭代对象串联起来，形成一个更大的迭代器。</p>
</li>
<li><p><strong><em><code>groupby()</code></em></strong>把迭代器中相邻的重复元素挑出来放在一起。</p>
</li>
</ul>
</li>
</ul>
<h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><ul>
<li><p>在Python中使用<code>SAX</code>解析<code>XML</code>非常简洁，通常我们关心的事件是<code>start_element</code>，<code>end_element</code>和<code>char_data</code>，准备好这3个函数，然后就可以解析<code>xml</code>了。</p>
</li>
<li><p>解析<code>XML</code>时，注意找出自己感兴趣的节点，响应事件时，把节点数据保存起来。解析完毕后，就可以处理数据。</p>
</li>
</ul>
<p>##HTMLParser</p>
<ul>
<li><p><code>HTMLParser</code>是用来解析<code>HTML</code>的模块。</p>
</li>
<li><p>利用<code>HTMLParser</code>，可以把网页中的文本、图像等解析出来。</p>
</li>
<li><p>有一个更好用的第三方模块<code>BeautifulSoup</code>是对<code>HTMLParser</code>的人性化封装，可以更简洁的解析<code>XML</code>和<code>HTML</code>。</p>
</li>
</ul>
<p>##urllib</p>
<ul>
<li><p><code>urllib·</code>提供了一系列用于操作<code>URL</code>的功能。</p>
</li>
<li><p><code>urllib</code>提供的功能就是利用程序去执行各种<code>HTTP</code>请求。</p>
</li>
<li><p>如果要模拟浏览器完成特定功能，需要把请求伪装成浏览器。伪装的方法是先监控浏览器发出的请求，再根据浏览器的请求头来伪装，<code>User-Agent</code>头就是用来标识浏览器的。</p>
</li>
<li><p>有一个更好用的第三方模块<code>requests</code>是对<code>urllib</code>的人性化封装，可以更好的操作<code>url</code>。</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="ReedSun" />
          <p class="site-author-name" itemprop="name">ReedSun</p>
           
              <p class="site-description motion-element" itemprop="description">ReedSun</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">64</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ReedSun</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

</body>
</html>
